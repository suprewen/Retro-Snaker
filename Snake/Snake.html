<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>å¥‡æ€ªè´ªåƒè›‡</title>
    <style>
        .map{
            height: 500px;
            width: 500px;
            margin: 0 auto;
            background-color: #cccccc;
            position: relative;
        }
        .bc{
            position: relative;
        }
        button{
            height: 200px;
            width: 200px;
            border-radius: 50%;
            border: none;
            font-size: 50px;
        }
        .bc_top{
            width: 200px;
            height: 200px;
            margin: 100px auto 0;
        }
        .bc_randl{
            width:600px;
            height: 200px;
            margin: 0 auto;
        }
        #left{
            margin-right: 190px;
        }
        .bc_down{
            width: 200px;
            height: 200px;
            margin:0 auto;
        }

    </style>
    <script>
        window.onload=function () {
//--å­˜æ”¾é£Ÿç‰©çš„æ•°ç»„
            var elements=[];
//--é£Ÿç‰©æ„é€ å‡½æ•°
            function Food() {
                this.x=0;
                this.y=0;
                this.width=20;
                this.height=20;
                this.color="green";
            }
//åˆ›å»ºé£Ÿç‰©
            Food.prototype.init=function (m) {
                remove(elements);
                var div=document.createElement("div");
                m.appendChild(div);
                div.style.position="absolute";
                div.style.width=this.width+"px";
                div.style.height=this.height+"px";
                div.style.backgroundColor=this.color;

                this.x=parseInt(Math.random()*m.offsetWidth/this.width)*this.width;
                this.y=parseInt(Math.random()*m.offsetWidth/this.height)*this.height;

                div.style.left=this.x+"px";
                div.style.top=this.y+"px";


                elements.push(div);
            }
//ç§»é™¤å…ƒç´ 
            function remove(elements) {
                for (var i=elements.length-1;i>=0;i--){
                    var element=elements[i];
                    element.parentNode.removeChild(element);
                    elements.splice(i,1);
                }
            }
//å­˜æ”¾è›‡çš„æ¯ä¸ªèº«ä½“æ ¼çš„æ•°ç»„
            var snake=[];
            //è›‡çš„æ„é€ å‡½æ•°
            function Snake(direction) {
                this.width=20;
                this.height=20;
                this.body=[
                    {x:3,y:2,color:"red"},
                    {x:2,y:2,color:"orange"},
                    {x:1,y:2,color:"orange"},
                ];
                this.direction=direction||"right";
            }
//åˆ›å»ºè›‡
            Snake.prototype.init=function (m) {
                remove(snake);
                for (var i=0;i<this.body.length;i++){
                    var div=document.createElement("div");
                    m.appendChild(div);
                    div.style.position="absolute";
                    div.style.width=this.width+"px";
                    div.style.height=this.height+"px";
                    div.style.backgroundColor=this.body[i].color;
                    div.style.left=this.body[i].x*this.width+"px";
                    div.style.top=this.body[i].y*this.height+"px";

                    snake.push(div);
                }
            }
            //ç§»åŠ¨è›‡
            Snake.prototype.move=function (food,m) {

                for (var i=this.body.length-1;i>0;i--){
                    this.body[i].x=this.body[i-1].x;
                    this.body[i].y=this.body[i-1].y;
                }

                switch (this.direction) {
                    case "right":
                        this.body[0].x+=1;
                        break;
                    case "left":
                        this.body[0].x-=1;
                        break;
                    case "top":
                        this.body[0].y-=1;
                        break;
                    case "bottom":
                        this.body[0].y+=1;
                        break;
                }

                if(this.body[0].x*this.width==food.x&&this.body[0].y*this.height==food.y){
                    var last=this.body[this.body.length-1];
                    this.body.push({
                        x:last.x,
                        y:last.y,
                        color:last.color
                    })
                    food.init(m);
                }
            }




            function runSnake() {
                var map=document.querySelector(".map");
                var fd=new Food();
                fd.init(map);

                //var btn=document.getElementsByTagName("button");

                var sk=new Snake();
                var timer=setInterval(function () {
                    sk.init(map);
                    sk.move(fd,map);
                    if(sk.body[0].x>=map.offsetWidth/sk.width){
                        sk.body[0].x=0;
                    }
                    if(sk.body[0].x<0){
                        sk.body[0].x=map.offsetWidth/sk.width-1;
                    }
                    if(sk.body[0].y>=map.offsetHeight/sk.height){
                        sk.body[0].y=0;
                    }
                    if(sk.body[0].y<0){
                        sk.body[0].y=map.offsetHeight/sk.height-1;
                    }
                },100);

                /*btn[0].onclick=function(){
                    sk.direction="top";
                };
                btn[1].onclick=function(){
                    sk.direction="left";
                };
                btn[2].onclick=function(){
                    sk.direction="right";
                };
                btn[3].onclick=function(){
                    sk.direction="bottom";
                };*/

                document.addEventListener("keydown",function(e){
                    e.cancelBubble=true;
                    switch (e.keyCode) {
                        case 37:
                            sk.direction="left";
                            break;
                        case 38:sk.direction="top";break;
                        case 39:sk.direction="right";break;
                        case 40:sk.direction="bottom";break;
                    }
                });
            }

            runSnake();


        }
    </script>
</head>
<body>
    <div class="map"></div>
    <div class="bc">
        <!--<div class="bc_top">
            <button id="up" type="button">ğŸ‘†</button>
        </div>
        <div class="bc_randl">
            <button id="left" type="button">ğŸ‘ˆ</button>
            <button id="right" type="button">ğŸ‘‰</button>
        </div>
        <div class="bc_down">
            <button id="down" type="button">ğŸ‘‡</button>
        </div>-->

    </div>
</body>
</html>